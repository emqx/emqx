Optimize idle memory usage and reduce the cost of maintaining rate-based metrics.

Note that various _5-minute average rate_ metrics exposed via APIs are no longer exact averages over the last 300 samples, but are instead EWMAs that approximate them closely.
